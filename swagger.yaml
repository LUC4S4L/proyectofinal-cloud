openapi: 3.0.1
info:
  title: API Compras
  description: API para registrar y listar compras de cursos
  version: 1.0.0

servers:
  - url: https://<API_ID>.execute-api.us-east-1.amazonaws.com/dev
    description: API Gateway desplegado

paths:
  /compras/registrar:
    post:
      summary: Registrar una nueva compra
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - curso_id
                - monto_pagado
              properties:
                curso_id:
                  type: string
                  example: "0984aa2e-2c7d-4492-9775-eb546ddd089f"
                monto_pagado:
                  type: number
                  format: float
                  example: 89.99
      responses:
        '201':
          description: Compra registrada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  compra_id:
                    type: string
        '400':
          description: Error en los datos enviados
        '403':
          description: Curso no pertenece al tenant
        '404':
          description: Curso no encontrado
        '500':
          description: Error interno

  /compras/listar:
    post:
      summary: Listar compras del usuario autenticado
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de compras realizadas
          content:
            application/json:
              schema:
                type: object
                properties:
                  compras:
                    type: array
                    items:
                      type: object
                      properties:
                        compra_id:
                          type: string
                        curso_id:
                          type: string
                        nombre_curso:
                          type: string
                        monto_pagado:
                          type: number
                        fecha_compra:
                          type: string
                          format: date-time
                        curso_detalle:
                          type: object
        '500':
          description: Error interno

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
